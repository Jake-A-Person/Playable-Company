je_pc_update_modifers = {
	icon = "gfx/interface/icons/event_icons/event_military.dds"

	group = je_group_internal_affairs

	possible = {
		this = c:PCM
	}

	on_monthly_pulse = {
		effect = {
			set_variable = {
				name = pc_num_corp_admin_var
				value = 0
			}
			set_variable = {
				name = pc_corp_construction_var
				value = 0
			}
			every_country = {
				#resets the var at the root for each country
				#var is at root so can use prev scope
				ROOT = {
					set_variable = {
						name = pc_corp_building_cost_var
						value = 0
					}
				}
				limit = {
					not = {
						is_country_type = decentralized
					}
				}
				every_scope_building = {
					limit = {
						levels_owned_by_country = {
							target = root
							value > 0
						}
					}
					if = {
						limit = {
							is_building_type = building_pc_corp_administration
						}
						ROOT = {
							change_variable = {
								name = pc_num_corp_admin_var
								add = prev.level
							}
						}
						#cant use prev and set var per conutry as putting
						#a prev in a prev wont give the building scope
						ROOT = {
							change_variable = {
								name = pc_corp_building_cost_var
								add = prev.weekly_profit
							}
						}
					}
					else_if = {
						limit = {
							is_building_type = building_pc_corp_construction_sector
						}
						root = {
							set_variable = {
								name = pc_corp_num_construction_var
								value = prev.level
							}
						}
						root = {
							change_variable = {
								name = pc_corp_building_cost_var
								add = prev.weekly_profit
							}

						}
						if = {
							limit = { has_active_production_method = pm_pc_corp_wooden_buildings }
							ROOT = {
								change_variable = {
									name = pc_corp_num_construction_var
									multiply = 2
								}
							}
						}
						else_if = {
							limit = { has_active_production_method = pm_pc_corp_iron_frame_buildings }
							ROOT = {
								change_variable = {
									name = pc_corp_num_construction_var
									multiply = 5
								}
							}
						}
						else_if = {
							limit = { has_active_production_method = pm_pc_corp_steel_frame_buildings }
							ROOT = {
								change_variable = {
									name = pc_corp_num_construction_var
									multiply = 10
								}
							}
						}
						else_if = {
							limit = { has_active_production_method = pm_pc_corp_arc_welded_buildings }
							ROOT = {
								change_variable = {
									name = pc_corp_num_construction_var
									multiply = 15
								}
							}
						}
						root = {
							change_variable = {
								name = pc_corp_construction_var
								add = var:pc_corp_num_construction_var
							}
						}
					}
					else = {
						if = {
							limit = {
								root = {
									has_variable = pc_corp_building_spec_iron_var
								}
								is_building_type = building_iron_mine
							}
							add_modifier = {
								name = pc_corp_build_throughput
								days = 30
							}
						}
						else_if = {
							limit = {
								root = {
									has_variable = pc_corp_building_spec_coal_var
								}
								is_building_type = building_coal_mine
							}
							add_modifier = {
								name = pc_corp_build_throughput
								days = 30
							}
						}
						else_if = {
							limit = {
								root = {
									has_variable = pc_corp_building_spec_coffe_var
								}
								is_building_type = building_coffee_plantation
							}
							add_modifier = {
								name = pc_corp_build_throughput
								days = 30
							}
						}
						else_if = {
							limit = {
								root = {
									has_variable = pc_corp_building_spec_tea_var
								}
								is_building_type = building_tea_plantation
							}
							add_modifier = {
								name = pc_corp_build_throughput
								days = 30
							}
						}
						else_if = {
							limit = {
								root = {
									has_variable = pc_corp_building_spec_rubber_var
								}
								is_building_type = building_rubber_plantation
							}
							add_modifier = {
								name = pc_corp_build_throughput
								days = 30
							}
						}
						else_if = {
							limit = {
								root = {
									has_variable = pc_corp_building_spec_logging_var
								}
								is_building_type = building_logging_camp
							}
							add_modifier = {
								name = pc_corp_build_throughput
								days = 30
							}
						}
						else_if = {
							limit = {
								root = {
									has_variable = pc_corp_building_spec_opium_var
								}
								is_building_type = building_opium_plantation
							}
							add_modifier = {
								name = pc_corp_build_throughput
								days = 30
							}
						}
						else_if = {
							limit = {
								has_variable = pc_corp_building_spec_food_var
								is_building_type = building_food_industry
							}
							add_modifier = {
								name = pc_corp_build_throughput
								days = 30
							}
						}
						else_if = {
							limit = {
								root = {
									has_variable = pc_corp_building_spec_tooling_var
								}
								is_building_type = building_tooling_workshop
							}
							add_modifier = {
								name = pc_corp_build_throughput
								days = 30
							}
						}
						else_if = {
							limit = {
								root = {
									has_variable = pc_corp_building_spec_textile_var
								}
								is_building_type = building_textile_mill
							}
							add_modifier = {
								name = pc_corp_build_throughput
								days = 30
							}
						}
						else_if = {
							limit = {
								root = {
									has_variable = pc_corp_building_spec_oil_var
								}
								is_building_type = building_oil_rig
							}
							add_modifier = {
								name = pc_corp_build_throughput
								days = 30
							}
						}
						else_if = {
							limit = {
								root = {
									has_variable = pc_corp_building_spec_steel_var
								}
								is_building_type = building_steel_mill
							}
							add_modifier = {
								name = pc_corp_build_throughput
								days = 30
							}
						}
						else_if = {
							limit = {
								root = {
									has_variable = pc_corp_building_spec_trade_var
								}
								is_building_type = building_trade_center
							}
							add_modifier = {
								name = pc_corp_build_throughput
								days = 30
							}
						}
					}
				}
				#if this country has corp buildings
				#then create a modifer to offset the cost
				if = {
					limit = {
						not = {
							root.var:pc_corp_building_cost_var = 0
						}
					}
					add_modifier = {
						name = pc_corp_building_cost_offset
						#pc_corp_building_cost_offset is -1 
						#pc_corp_building_cost_var is -ve (pc_corp_building_cost_var < 0)
						#so the effect witll be +ve (effect > 0)
						multiplier = root.var:pc_corp_building_cost_var
						days = 30
					}
					root = {
						add_modifier = {
							name = pc_corp_building_cost
							#pc_corp_building_cost_offset is -1 
							#pc_corp_building_cost_var is -ve (pc_corp_building_cost_var < 0)
							#so the effect will be +ve (effect > 0)
							multiplier = var:pc_corp_building_cost_var
							days = 30
						}
					}
				}

			}
			change_variable = {
				name = pc_num_corp_admin_var
				#how much bureaucracy (how many builing you can own) with 1 corporate admin building
				multiply = 20
			}
			add_modifier = {
				name = pc_corp_admin_bureau
				multiplier = var:pc_num_corp_admin_var
				#update each month so it auto clears
				#30 days so there isn't any overlap
				days = 30
			}
			add_modifier = {
				name = pc_corp_construction
				multiplier = var:pc_corp_construction_var
				#update each month so it auto clears
				days = 30
			}
		}
	}

	weight = 100
	should_be_pinned_by_default = yes
}